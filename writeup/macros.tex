\newcommand{\tagcolor}{C}

\newcommand{\vt}{\mathit{\color{blue} vt}}
\newcommand{\pt}{\mathit{\color{blue} pt}}
\newcommand{\lt}{\mathit{\color{blue} lt}}
\newcommand{\lts}{\overline{\color{blue} \lt}}
\newcommand{\nt}{\mathit{\color{blue} nt}}
\newcommand{\PCT}{\mathcal{\color{blue} P}}

%%% Policy Specific Tags %%%
\newcommand{\N}{{\color{blue} N}}
%% Memory Safety %%
\newcommand{\tagz}{{\color{blue} 0}}
\newcommand{\tagone}{{\color{blue} 1}}
%% SIF %%
\newcommand{\vtaint}[1]{\mathit{\color{blue} vtaint ~ #1}}
\newcommand{\pctaint}[1]{\mathit{\color{blue} pc ~ #1}}

\newcommand{\trule}[2]{{\color{blue} #1 \leftarrow #2}}

\newcommand{\truledef}[1]{
  & \multispan{3} \({\color{blue} #1}\) \\}

\newcommand{\assert}[1]{& & & \multispan{2} \(\mathbf{assert} ~ #1\) \hfill \\}
\newcommand{\letin}[1]{& & & \multispan{2} \(\mathit{let} ~ #1 ~ \mathit{in}\) \\}

\newcommand{\caseof}[1]{\textnormal{case } #1 \textnormal{ of}}
\newcommand{\caseentry}[2]{& & & #1 \Rightarrow #2}

\newcommand{\optional}[1]{\fcolorbox{black}{gray!20}{#1}}
\newcommand{\settag}[2]{\boldsymbol{#1} & \longleftarrow & & \mathit{#2}\\}
\newcommand{\settagopt}[2]{\optional{\(\boldsymbol{#1}\)} & \longleftarrow & & \mathit{#2}\\}

%%% Tag Rules %%%
\newcommand{\loadtname}{\mathbf{LoadT}}
\newcommand{\loadtargs}{\PCT, \pt, \vt, \overline{\lt}}
\newcommand{\loadtres}{\vt'}
\newcommand{\loadt}{\loadtname(\loadtargs)}

\newcommand{\storetname}{\mathbf{StoreT}}
\newcommand{\storetargs}{\PCT, \pt, \vt_1, \vt_2, \overline{\lt}}
\newcommand{\storetres}{\PCT',\vt',\overline{\lt}'}
\newcommand{\storet}{\storetname(\storetargs)}

\newcommand{\volloadtname}{\mathbf{VolLoadT}}
\newcommand{\volloadtargs}{\PCT, \pt, \vt, \overline{\lt}}
\newcommand{\volloadtres}{\vt'}
\newcommand{\volloadt}{\volloadtname(\volloadtargs)}

\newcommand{\volstoretname}{\mathbf{VolStoreT}}
\newcommand{\volstoretargs}{\PCT, \pt, \vt_1, \vt_2, \overline{\lt}}
\newcommand{\volstoretres}{\PCT',\vt',\overline{\lt}'}
\newcommand{\volstoret}{\volstoretname(\volstoretargs)}

\newcommand{\consttname}{\mathbf{ConstT}}
\newcommand{\consttres}{\vt}
\newcommand{\constt}{\consttname}

\newcommand{\unoptname}{\mathbf{UnopT}}
\newcommand{\unoptargs}{\PCT, \vt}
\newcommand{\unoptres}{\vt}
\newcommand{\unopt}{\unoptname(\unoptargs)}

\newcommand{\binoptname}{\mathbf{BinopT}}
\newcommand{\binoptargs}{\oplus, \PCT, \vt_1, \vt_2}
\newcommand{\binoptres}{\vt'}
\newcommand{\binopt}{\binoptname(\binoptargs)}

\newcommand{\globaltname}{\mathbf{GlobalT}}
\newcommand{\globaltargs}{id, s}
\newcommand{\globaltargstyped}{id \in ident, s \in \mathbb{N}}
\newcommand{\globaltres}{\pt,\vt,\overline{\lt}}
\newcommand{\globalt}{\globaltname(\globaltargs)}

\newcommand{\localtname}{\mathbf{LocalT}}
\newcommand{\localtargs}{\PCT, id, s}
\newcommand{\localtargstyped}{\PCT, id \in ident, s \in \mathbb{N}}
\newcommand{\localtres}{\pt,\vt,\overline{\lt}}
\newcommand{\localt}{\localtname(\localtargs)}

\newcommand{\dealloctname}{\mathbf{DeallocT}}
\newcommand{\dealloctargs}{\PCT, id, s}
\newcommand{\dealloctargstyped}{\PCT, id \in ident, s \in \mathbb{N}}
\newcommand{\dealloctres}{\vt,\overline{\lt}}
\newcommand{\dealloct}{\dealloctname(\dealloctargs)}

\newcommand{\vartname}{\mathbf{VarT}}
\newcommand{\vartargs}{\PCT, \vt}
\newcommand{\vartres}{\pt}
\newcommand{\vart}{\vartname(\vartargs)}

\newcommand{\malloctname}{\mathbf{MallocT}}
\newcommand{\malloctargs}{\PCT, \vt}
\newcommand{\malloctres}{\PCT',\pt,\optional{\(\vt,\overline{\lt}\)}}
\newcommand{\malloct}{\malloctname(\malloctargs)}

\newcommand{\freetname}{\mathbf{FreeT}}
\newcommand{\freetargs}{\PCT, \vt}
\newcommand{\freetres}{\PCT',\pt,\optional{\(\vt,\overline{\lt}\)}}
\newcommand{\freet}{\freetname(\freetargs)}

\newcommand{\picasttname}{\mathbf{PICastT}}
\newcommand{\picasttargs}{\PCT, \pt, \optional{\(\vt, \overline{\lt}\)}}
\newcommand{\picasttres}{\PCT',\vt}
\newcommand{\picastt}{\picasttname(\picasttargs)}

\newcommand{\ipcasttname}{\mathbf{IPCastT}}
\newcommand{\ipcasttargs}{\PCT, \vt_1, \optional{\(\vt_2, \overline{\lt}\)}}
\newcommand{\ipcasttres}{\PCT',\pt}
\newcommand{\ipcastt}{\ipcasttname(\ipcasttargs)}

\newcommand{\ppcasttname}{\mathbf{PPCastT}}
\newcommand{\ppcasttargs}{\PCT, \pt, \optional{\(\vt, \overline{\lt}\)}}
\newcommand{\ppcasttres}{\PCT',\pt'}
\newcommand{\ppcastt}{\picasttname(\picasttargs)}

\newcommand{\iicasttname}{\mathbf{IICastT}}
\newcommand{\iicasttargs}{\PCT, \vt_1}
\newcommand{\iicasttres}{\PCT',\pt}
\newcommand{\iicastt}{\ipcasttname(\ipcasttargs)}

\newcommand{\splittname}{\mathbf{SplitT}}
\newcommand{\splittargs}{\PCT, \vt, \optional{\(L\)}}
\newcommand{\splittres}{\PCT'}
\newcommand{\splitt}{\splittname(\splittargs)}
           
\newcommand{\labeltname}{\mathbf{LabelT}}
\newcommand{\labeltargs}{\PCT, L}
\newcommand{\labeltres}{\PCT'}
\newcommand{\labelt}{\labeltname(\labeltargs)}

\newcommand{\calltname}{\mathbf{CallT}}
\newcommand{\calltargs}{\PCT, f, f'}
\newcommand{\calltres}{\PCT'}
\newcommand{\callt}{\calltname(\calltargs)}

\newcommand{\argtname}{\mathbf{ArgT}}
\newcommand{\argtargs}{\PCT, \vt, f, x}
\newcommand{\argtargstyped}{\PCT, \vt, f, x \in ident}
\newcommand{\argtres}{\vt',\lts}
\newcommand{\argt}{\argtname(\argtargs)}

\newcommand{\rettname}{\mathbf{RetT}}
\newcommand{\rettargs}{\PCT_{CLE}, \PCT_{CLR}, \vt}
\newcommand{\rettres}{\PCT',\vt'}
\newcommand{\rett}{\rettname(\rettargs)}

\newcommand{\extcalltname}{\mathbf{ExtCallT}}
\newcommand{\extcalltargs}{\PCT, f, f', \overline{\vt}}
\newcommand{\extcalltres}{\PCT', \vt'}
\newcommand{\extcallt}{\extcalltname(\extcalltargs)}

%%%%%%%%%%%%%%%%%

%%% Continuations, States, Values %%%

\newcommand{\kemp}{\mathit{Kemp}}
\newcommand{\kdo}[1]{\mathit{Kdo};~ #1}
\newcommand{\kseq}[2]{\mathit{Kseq} ~ #1; ~ #2}
\newcommand{\kif}[4]{\mathit{Kif}[#1 \mid #2] ~ \mathit{join} ~ #3; ~ #4}
\newcommand{\kwhiletest}[4]{\mathit{KwhileTest}(#1) ~ \{ ~ #2 ~ \} ~ \mathit{join} ~ #3; ~ #4}
\newcommand{\kwhileloop}[4]{\mathit{KwhileLoop}(#1) ~ \{ ~ #2 ~ \} ~ \mathit{join} ~ #3; ~ #4}
\newcommand{\kdowhiletest}[4]{\mathit{KdoWhileTest}(#1) ~ \{ ~ #2 ~ \} ~ \mathit{join} ~ #3; ~ #4}
\newcommand{\kdowhileloop}[4]{\mathit{KdoWhileLoop}(#1) ~ \{ ~ #2 ~ \} ~ \mathit{join} ~ #3; ~ #4}
\newcommand{\kfor}[2]{\mathit{Kfor} ~ #1; ~ #2}
\newcommand{\kforpost}[2]{\mathit{KforPost} ~ #1; ~ #2}
\newcommand{\kcall}[3]{\mathit{Kcall} ~ #1 ~ #2 ~ #3}

\newcommand{\ctx}[1]{ctx \left[#1\right]}

\newcommand{\sstate}[4]{\mathcal{S}\left(#2 \mid #3 \gg #4 @ #1\right)}
\newcommand{\estate}[4]{\mathcal{E}\left(#2 \mid #3 \gg #4 @ #1\right)}
\newcommand{\cstate}[7]{\mathcal{C}\left(#1,#3,#4 \mid #5(#6) \gg #7 @ #2\right)}
\newcommand{\rstate}[6]{\mathcal{R}\left(#2,#3,#4 \mid #5 \gg #6 @ #1\right)}
\newcommand{\fstate}[1]{\mathcal{F}\left(#1\right)}

\newcommand{\mem}{m}
\newcommand{\genv}{\mathit{ge}}
\newcommand{\lenv}{\mathit{le}}
\newcommand{\cont}{k}
\newcommand{\stmt}{s}
\newcommand{\expr}{e}
\newcommand{\type}{ty}
\newcommand{\defestate}[1]
           {\estate{\PCT}{\mem}{#1}{\cont}}
\newcommand{\defsstate}[1]
           {\sstate{\PCT}{\mem}{#1}{\cont}}

%% Expressions $$
\newcommand{\val}[2]{\mathit{Eval} ~ #1@#2}
\newcommand{\var}[1]{\mathit{Evar} ~ #1}
\newcommand{\field}[2]{\mathit{Efield} ~ #1 ~ #2}
\newcommand{\valof}[1]{\mathit{EvalOf} ~ #1}
\newcommand{\deref}[1]{\mathit{Ederef} ~ #1}
\newcommand{\addrof}[1]{\mathit{EaddrOf} ~ #1}
\newcommand{\unop}[2]{\mathit{Eunop} ~ #1 ~ #2}
\newcommand{\binop}[3]{\mathit{Ebinop} ~ #1 ~ #2 ~ #3}
\newcommand{\cast}[2]{\mathit{Ecast} ~ #1 ~ #2}
\newcommand{\seqand}[2]{\mathit{EseqAnd ~ #1 ~ #2}}
\newcommand{\seqor}[2]{\mathit{EseqOr ~ #1 ~ #2}}
\newcommand{\condition}[3]{\mathit{Econd} ~ #1 ~ #2 ~ #3}
\newcommand{\sizeof}[1]{\mathit{Esize} ~ #1}
\newcommand{\alignof}[1]{\mathit{Ealign} ~ #1}
\newcommand{\assign}[2]{\mathit{Eassign ~ #1 ~ #2}}
\newcommand{\assignop}[3]{\mathit{EassignOp ~ #1 ~ #2 ~ #3}}
\newcommand{\postinc}[2]{\mathit{EpostInc} ~ #1 ~ #2}
\newcommand{\comma}[2]{\mathit{Ecomma} ~ #1 ~ #2}
\newcommand{\call}[2]{\mathit{Ecall} ~ #1(#2)}
\newcommand{\builtin}[2]{\mathit{Ebuiltin} ~ #1(#2)}
\newcommand{\loc}[2]{\mathit{Eloc} ~ #1@#2}
\newcommand{\floc}[2]{\mathit{Efloc} ~ #1@#2}
\newcommand{\paren}[2]{\mathit{Eparen} ~ #1 ~ #2}
\newcommand{\failstop}{\mathit{Efailstop}}

\newcommand{\sskip}{\mathtt{Sskip}}
\newcommand{\sdo}[1]{\mathtt{Sdo} ~ #1}
\newcommand{\sseq}[2]{\mathtt{Sseq} ~ #1 ~ #2}
\newcommand{\sifthenelse}[4]{\mathtt{Sif}(#1) ~ \mathtt{then} ~ #2 ~ \mathtt{else} ~ #3 ~ \mathtt{join} ~ #4}
\newcommand{\swhile}[3]{\mathtt{Swhile}(#1) ~ \mathtt{do} ~ #2 ~ \mathtt{join} ~ #3}
\newcommand{\sdowhile}[3]{\mathtt{Sdo} ~ #2 ~ \mathtt{while} ~ (#1) ~ \mathtt{join} ~ #3}
\newcommand{\sfor}[5]{\mathtt{Sfor}(#1; #2; #3) ~ \mathtt{do} ~ #4 ~ \mathtt{join} ~ #5}
\newcommand{\sbreak}{\mathtt{Sbreak}}
\newcommand{\scontinue}{\mathtt{Scontinue}}
\newcommand{\sreturn}{\mathtt{Sreturn}}
\newcommand{\sswitch}[2]{\mathtt{Sswitch} ~ #1 ~ \{ ~ #2 ~ \}}
\newcommand{\slabel}[2]{\mathtt{Slabel} ~ #1: ~ #2}
\newcommand{\sgoto}[1]{\mathtt{Sgoto} ~ #1}

\newcommand{\vundef}{\mathbf{undef}}

\newcommand{\tptr}[1]{\mathit{ptr(#1)}}

\newcommand{\judgment}[3][]{
  {\centering
  \smallskip
  \begin{tabular}{c}
    #2 \\
    \hline
    #3
  \end{tabular}{\sc #1}
  \smallskip\par}}

\newcommand{\judgmentbr}[4][]{
  {\centering
  \smallskip
  \begin{tabular}{c}
    #2 \\
    #3 \\
    \hline
    #4
  \end{tabular}{\sc #1}
   \smallskip\par}}

\newcommand{\judgmentbrbr}[5][]{
  {\centering
  \smallskip
  \begin{tabular}{c}
    #2 \\
    #3 \\
    #4 \\
    \hline
    #5
  \end{tabular}{\sc #1}
   \smallskip\par}}

\newcommand{\judgmentbrbrbr}[6][]{
  {\centering
  \smallskip
  \begin{tabular}{c}
    #2 \\
    #3 \\
    #4 \\
    #5 \\
    \hline
    #6
  \end{tabular}{\sc #1}
   \smallskip\par}}

\newcommand{\judgmenttwobr}[6][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c}
       #2 & #3 \\
       #4 & #5 \\
       \hline
       \multicolumn{2}{c}{#6}
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}

\newcommand{\judgmenttwobrlong}[5][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c}
       #2 & #3 \\
       \multicolumn{2}{c}{#4} \\
       \hline
       \multicolumn{2}{c}{#5}
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}

\newcommand{\judgmentthreebrlong}[6][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c c}
       #2 & #3 & #4 \\
       \multicolumn{3}{c}{#5} \\
       \hline
       \multicolumn{3}{c}{#6}
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}

\newcommand{\judgmentthreebrtwo}[7][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c c}
       #2 & #3 & #4 \\
       \multicolumn{3}{c}{#5 \hfill #6} \\
       \hline
       \multicolumn{3}{c}{#7}
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}

\newcommand{\judgmenttwobrlongbrlong}[6][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c}
       #2 & #3 \\
       \multicolumn{2}{c}{#4} \\
       \multicolumn{2}{c}{#5} \\
       \hline
       \multicolumn{2}{c}{#6} \\
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}


\newcommand{\judgmentthreebr}[8][]{
  {
    \centering
    \smallskip
    \begin{tabular}{c c c}
       #2 & #3 & #4 \\
       #5 & #6 & #7 \\
       \hline
       \multicolumn{3}{c}{#8}
    \end{tabular}{\sc #1}
    \vspace{\belowdisplayskip}\par
  }}


\newcommand{\judgmenttwo}[4][]{
  {\centering
  \smallskip
  \begin{tabular}{c c}
    #2 & #3 \\
    \hline
    \multicolumn{2}{c}{#4}
  \end{tabular}{\sc #1}
  \smallskip\par}}

\newcommand{\judgmentthree}[5][]{
  {\centering
  \smallskip
  \begin{tabular}{c c c}
    #2 & #3 & #4 \\
    \hline
    \multicolumn{3}{c}{#5}
  \end{tabular}{\sc #1}
  \smallskip\par}}

\newcommand{\judgmentfour}[6][]{
  {\centering
  \smallskip
  \begin{tabular}{c c c c}
    #2 & #3 & #4 & #5 \\
    \hline
    \multicolumn{4}{c}{#6}
  \end{tabular}{\sc #1}
  \smallskip\par}}
